import{y as C,r as P,W as k,X as E,o as Q,h as R,z as V,g as j,Y as S,P as D,Z as I,D as O,$ as _,a0 as w,k as q,n as T,a1 as $,l as z,m as K,a2 as L,a3 as M,a4 as N,j as W,F as X}from"./index.27345aab.js";import{Q as Y}from"./QBanner.eeb49862.js";var H=C({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validation-success","validation-error"],setup(o,{slots:v,emit:i}){const p=j(),l=P(null);let n=0;const s=[];function g(e){const r=[],d=typeof e=="boolean"?e:o.noErrorFocus!==!0,B=++n,m=(a,t)=>{i("validation-"+(a===!0?"success":"error"),t)};for(let a=0;a<s.length;a++){const t=s[a],c=t.validate();if(typeof c.then=="function")r.push(c.then(u=>({valid:u,comp:t}),u=>({valid:!1,comp:t,err:u})));else if(c!==!0){if(o.greedy===!1)return m(!1,t),d===!0&&typeof t.focus=="function"&&t.focus(),Promise.resolve(!1);r.push({valid:!1,comp:t})}}return r.length===0?(m(!0),Promise.resolve(!0)):Promise.all(r).then(a=>{const t=a.filter(A=>A.valid!==!0);if(t.length===0)return B===n&&m(!0),!0;const{valid:c,comp:u,err:F}=t[0];return B===n&&(F!==void 0&&console.error(F),m(!1,u),d===!0&&c!==!0&&typeof u.focus=="function"&&u.focus()),!1})}function y(){n++,s.forEach(e=>{typeof e.resetValidation=="function"&&e.resetValidation()})}function h(e){e!==void 0&&S(e);const r=n+1;g().then(d=>{r===n&&d===!0&&(o.onSubmit!==void 0?i("submit",e):e!==void 0&&e.target!==void 0&&typeof e.target.submit=="function"&&e.target.submit())})}function b(e){e!==void 0&&S(e),i("reset"),D(()=>{y(),o.autofocus===!0&&o.noResetFocus!==!0&&f()})}function f(){I(()=>{if(l.value===null)return;const e=l.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(l.value.querySelectorAll("[tabindex]"),r=>r.tabIndex>-1);e!=null&&e.focus({preventScroll:!0})})}O(_,{bindComponent(e){s.push(e)},unbindComponent(e){const r=s.indexOf(e);r>-1&&s.splice(r,1)}});let x=!1;return k(()=>{x=!0}),E(()=>{x===!0&&o.autofocus===!0&&f()}),Q(()=>{o.autofocus===!0&&f()}),Object.assign(p.proxy,{validate:g,resetValidation:y,submit:h,reset:b,focus:f,getValidationComponents:()=>s}),()=>R("form",{class:"q-form",ref:l,onSubmit:h,onReset:b},V(v.default))}});const J={__name:"ErrorsBanner",props:{errors:{required:!0,type:Array},class:{required:!1,type:[Object,Array,String],default:"bg-negative q-mt-sm text-white"},rounded:{required:!1,type:Boolean,default:!0}},setup(o){const i=w(o,"class");return(p,l)=>(q(!0),T(X,null,$(o.errors,n=>(q(),z(Y,N({key:n.message,rounded:o.rounded,class:W(i)},p.$attrs),{default:K(()=>[L(M(n.message),1)]),_:2},1040,["rounded","class"]))),128))}};export{H as Q,J as _};
