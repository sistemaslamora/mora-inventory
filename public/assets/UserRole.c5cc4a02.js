import{aW as $,r as l,V as q,u as Q,o as _,bm as z,k as c,n as y,d as t,m as r,x,l as C,q as d,p as B,F as T,a1 as N,a2 as U,a3 as V}from"./index.f090f687.js";import{Q as F}from"./QToolbar.fb10d56e.js";import{Q as S,a as D}from"./QTable.1449abad.js";import{Q as E}from"./QTr.3a2bacca.js";import{Q as L}from"./es.9c9819f8.js";import{u as O}from"./use-quasar.c8d55c62.js";import{h as M}from"./moment.9709ab41.js";import W from"./supabase.e1c942d3.js";import{_ as j}from"./plugin-vue_export-helper.21dcd24c.js";import"./QMenu.5d1b3d67.js";import"./_commonjsHelpers.d2428edb.js";import"./index.ea930b6c.js";const G=$({setup(){const a=O();l([]);const{user:u}=q(),{supabase:n}=W(),m=l(!0),p=l("");Q();const f=[{value:"662273d0-3830-4c16-af8e-e7a2a5384e49",label:"SuperAdmin"},{value:"171b07e2-de6c-4b2f-bd94-039676a7cf9b",label:"Controller"},{value:"2d5ec1d4-ce3e-4be9-a8c6-7a6aaae16a79",label:"Administradores"},{value:"e0a49454-2818-49d8-8f01-cfd6709ea721",label:"Usuarios"}],o=[{name:"Usuario",required:!0,label:"Usuario",align:"left",field:e=>e.email,format:e=>`${e}`,sortable:!0},{name:"Role",required:!0,align:"center",label:"Role",field:e=>e.bizrole.role,format:e=>`${e}`,sortable:!0},{name:"CreateAt",align:"center",label:"Fecha de Creacion",field:e=>h(e.created_at),format:e=>`${e}`,sortable:!0},{name:"actions",label:"Actions",field:"",align:"center"}],s=l(["CreateBy","CreateAt","actions"]),b=l([]),h=e=>M(e).locale("es").fromNow(),v=async()=>{(await n.from("bizrolebyuser").select("*").eq("userid",u.value.id)).status===200&&(m.value=!1);let i=await n.from("bizrolebyuser").select("*,bizrole(*)");i.status===200&&(b.value=i.data)};_(async()=>{v()});const w=e=>{a.dialog({title:"Role",message:`A\xF1ade el Role para: ${e.row.email}`,options:{type:"radio",model:"opt1",items:f},cancel:!0,persistent:!0}).onOk(async i=>{const R=f.find(A=>A.value===i);await n.from("bizrolebyuser").update({roleid:R.value}).eq("userid",e.row.userid),v()}).onCancel(()=>{}).onDismiss(()=>{})},g=()=>{a.dialog({title:"Role",message:`A\xF1ade el Role para: ${u.value.email}`,options:{type:"radio",model:"opt1",items:[{value:"662273d0-3830-4c16-af8e-e7a2a5384e49",label:"SuperAdmin"},{value:"171b07e2-de6c-4b2f-bd94-039676a7cf9b",label:"Controller"},{value:"2d5ec1d4-ce3e-4be9-a8c6-7a6aaae16a79",label:"Administradores"},{value:"e0a49454-2818-49d8-8f01-cfd6709ea721",label:"Usuarios"}]},cancel:!0,persistent:!0}).onOk(e=>{console.log(e)}).onCancel(()=>{}).onDismiss(()=>{})};z(()=>{s.value=a.screen.width>600?["CreateBy","CreateAt","actions"]:["actions"]});const k=e=>{};return{columns:o,rows:b,showAdd:m,visibleColumns:s,selected:l([]),dato:l(!1),editRow:k,addRole:g,editRole:w,show:p}}}),H={class:"q-pa-md q-gutter-y-sm"};function I(a,u,n,m,p,f){return c(),y("div",H,[t(F,{class:"bg-primary q-py-sm text-white",style:{"padding-top":"1rem"}},{default:r(()=>[a.showAdd?(c(),C(d,{key:0,stack:"",flat:"",size:"12px","no-caps":"",class:"q-mx-sm",label:"Nuevo",onClick:a.addRole,icon:"fa-solid fa-file-circle-plus",style:{"line-height":"1.5rem"}},null,8,["onClick"])):B("",!0),t(d,{flat:"",stack:"",size:"12px","no-caps":"",class:"q-mx-sm",label:"Ver Todos",icon:"fas fa-folder-tree",style:{"line-height":"1.5rem"}})]),_:1}),x("div",null,[t(S,{title:"Roles de Usuario",rows:a.rows,columns:a.columns,"visible-columns":a.visibleColumns,"row-key":"email",dense:""},{header:r(o=>[t(E,{props:o},{default:r(()=>[(c(!0),y(T,null,N(o.cols,s=>(c(),C(D,{key:s.name,props:o,class:"text-italic",style:{color:"#d4aa70","font-size":"1rem"}},{default:r(()=>[U(V(s.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"body-cell-actions":r(o=>[t(L,{props:o},{default:r(()=>[t(d,{dense:"",round:"",flat:"",color:"grey",onClick:s=>a.editRole(o),icon:"edit"},null,8,["onClick"]),t(d,{dense:"",round:"",flat:"",color:"grey",onClick:s=>a.deleteRow(o),icon:"delete"},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","visible-columns"])])])}var re=j(G,[["render",I]]);export{re as default};
